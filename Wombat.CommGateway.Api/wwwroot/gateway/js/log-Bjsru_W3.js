import{d as a,v as e,q as l,w as s,g as t,c as n,I as i,e as o,b as r,t as u,n as c,E as d,j as p,s as f}from"./index-Bm5b3KXf.js";import{_ as m}from"./_plugin-vue_export-helper-BCo6x5W8.js";var v=(a=>(a[a.Debug=0]="Debug",a[a.Information=1]="Information",a[a.Warning=2]="Warning",a[a.Error=3]="Error",a[a.Critical=4]="Critical",a[a.Fatal=5]="Fatal",a))(v||{}),g=(a=>(a[a.System=0]="System",a[a.Security=1]="Security",a[a.Performance=2]="Performance",a[a.Business=3]="Business",a[a.DataCollection=4]="DataCollection",a[a.Communication=5]="Communication",a[a.Operation=6]="Operation",a))(g||{});const b={key:0,class:"detail-container"},y={class:"card-header"},_={class:"header-actions"},D={class:"info-item"},h={class:"info-value"},C={class:"info-item"},k={class:"info-value"},w={class:"info-item"},L={class:"message-content"},I={class:"info-item"},S={class:"info-value"},O={class:"info-item"},T={class:"info-value"},x={class:"info-item"},N={class:"info-value"},R={class:"info-item"},j={class:"info-value"},z={class:"info-item"},B={class:"info-value"},E={class:"info-item"},A={class:"info-value"},U={class:"info-item"},V={class:"info-value"},F={class:"info-item"},P={class:"info-value"},W={class:"info-item"},J={class:"info-item"},$={class:"info-value"},q={class:"info-item"},G={class:"info-value"},K={class:"info-item"},Z={class:"user-agent"},H={class:"info-item"},M={class:"info-value"},Q={class:"info-item"},X={class:"info-value"},Y={class:"info-item"},aa={class:"info-value"},ea={class:"info-item"},la={class:"info-item"},sa={class:"info-value"},ta={class:"info-item"},na={class:"info-value"},ia={class:"info-item"},oa={class:"info-value"},ra={class:"info-item"},ua={class:"info-value"},ca={class:"info-item"},da={class:"endpoint"},pa={class:"card-header"},fa={class:"card-header"},ma={class:"properties-container"},va={class:"properties-json"},ga={class:"dialog-footer"},ba=m(a({__name:"LogDetail",props:{modelValue:{type:Boolean},logData:{}},emits:["update:modelValue"],setup(a,{emit:f}){const m=a,ba=f,ya=e({get:()=>m.modelValue,set:a=>ba("update:modelValue",a)}),_a=e((()=>{if(!m.logData)return"日志详情";return{[g.System]:"系统日志详情",[g.Operation]:"操作日志详情",[g.Communication]:"通信日志详情",[g.Security]:"安全日志详情",[g.Performance]:"性能日志详情",[g.Business]:"业务日志详情",[g.DataCollection]:"数据采集日志详情"}[m.logData.category]||"日志详情"})),Da=e((()=>{var a;return(null==(a=m.logData)?void 0:a.category)===g.System})),ha=e((()=>{var a;return(null==(a=m.logData)?void 0:a.category)===g.Operation})),Ca=e((()=>{var a;return(null==(a=m.logData)?void 0:a.category)===g.Communication})),ka=e((()=>m.logData)),wa=e((()=>m.logData)),La=e((()=>m.logData)),Ia=e((()=>{var a;return(null==(a=m.logData)?void 0:a.properties)&&Object.keys(m.logData.properties).length>0})),Sa=a=>({[v.Debug]:"DEBUG",[v.Information]:"INFO",[v.Warning]:"WARN",[v.Error]:"ERROR",[v.Critical]:"CRITICAL",[v.Fatal]:"FATAL"}[a]||"UNKNOWN"),Oa=a=>({[g.System]:"系统",[g.Security]:"安全",[g.Performance]:"性能",[g.Business]:"业务",[g.DataCollection]:"数据采集",[g.Communication]:"通信",[g.Operation]:"操作"}[a]||"未知"),Ta=async a=>{try{await navigator.clipboard.writeText(a),d.success("已复制到剪贴板")}catch(e){d.error("复制失败")}},xa=async()=>{if(!m.logData)return;const a=JSON.stringify(m.logData,null,2);await Ta(a)},Na=()=>{if(!m.logData)return;const a=JSON.stringify(m.logData,null,2),e=new Blob([a],{type:"application/json"}),l=URL.createObjectURL(e),s=document.createElement("a");s.href=l,s.download=`log_${m.logData.id}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l),d.success("日志已导出")};return(a,e)=>{const d=t("el-tag"),f=t("el-button"),m=t("el-col"),ba=t("el-row"),Ra=t("el-card"),ja=t("el-input"),za=t("el-dialog");return p(),l(za,{modelValue:ya.value,"onUpdate:modelValue":e[4]||(e[4]=a=>ya.value=a),title:_a.value,width:"80%","close-on-click-modal":!1,"destroy-on-close":"",class:"log-detail-dialog"},{footer:s((()=>[r("div",ga,[o(f,{onClick:e[3]||(e[3]=a=>ya.value=!1)},{default:s((()=>e[38]||(e[38]=[c("关闭")]))),_:1,__:[38]}),o(f,{type:"primary",onClick:xa},{default:s((()=>e[39]||(e[39]=[c("复制完整日志")]))),_:1,__:[39]}),o(f,{type:"success",onClick:Na},{default:s((()=>e[40]||(e[40]=[c("导出日志")]))),_:1,__:[40]})])])),default:s((()=>[a.logData?(p(),n("div",b,[o(Ra,{shadow:"never",class:"info-card"},{header:s((()=>{return[r("div",y,[e[5]||(e[5]=r("span",null,"基础信息",-1)),r("div",_,[o(d,{type:(t=a.logData.level,{[v.Debug]:"",[v.Information]:"success",[v.Warning]:"warning",[v.Error]:"danger",[v.Critical]:"danger",[v.Fatal]:"danger"}[t]||""),size:"small"},{default:s((()=>[c(u(Sa(a.logData.level)),1)])),_:1},8,["type"]),o(d,{type:(l=a.logData.category,{[g.System]:"info",[g.Security]:"warning",[g.Performance]:"success",[g.Business]:"primary",[g.DataCollection]:"",[g.Communication]:"success",[g.Operation]:"warning"}[l]||""),size:"small",effect:"plain"},{default:s((()=>[c(u(Oa(a.logData.category)),1)])),_:1},8,["type"])])])];var l,t})),default:s((()=>[o(ba,{gutter:20},{default:s((()=>[o(m,{span:12},{default:s((()=>[r("div",D,[e[7]||(e[7]=r("label",{class:"info-label"},"日志ID:",-1)),r("span",h,u(a.logData.id),1),o(f,{type:"primary",link:"",size:"small",onClick:e[0]||(e[0]=e=>Ta(a.logData.id))},{default:s((()=>e[6]||(e[6]=[c(" 复制 ")]))),_:1,__:[6]})])])),_:1}),o(m,{span:12},{default:s((()=>{return[r("div",C,[e[8]||(e[8]=r("label",{class:"info-label"},"记录时间:",-1)),r("span",k,u((l=a.logData.timestamp,new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}))),1)])];var l})),_:1}),o(m,{span:24},{default:s((()=>[r("div",w,[e[9]||(e[9]=r("label",{class:"info-label"},"日志消息:",-1)),r("div",L,u(a.logData.message),1)])])),_:1})])),_:1})])),_:1}),Da.value?(p(),l(Ra,{key:0,shadow:"never",class:"info-card"},{header:s((()=>e[10]||(e[10]=[r("span",null,"系统日志信息",-1)]))),default:s((()=>[o(ba,{gutter:20},{default:s((()=>[o(m,{span:12},{default:s((()=>[r("div",I,[e[11]||(e[11]=r("label",{class:"info-label"},"来源:",-1)),r("span",S,u(ka.value.source||"未知"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",O,[e[12]||(e[12]=r("label",{class:"info-label"},"环境:",-1)),r("span",T,u(ka.value.environment||"未知"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",x,[e[13]||(e[13]=r("label",{class:"info-label"},"线程ID:",-1)),r("span",N,u(ka.value.threadId||"未知"),1)])])),_:1})])),_:1})])),_:1})):i("",!0),ha.value?(p(),l(Ra,{key:1,shadow:"never",class:"info-card"},{header:s((()=>e[14]||(e[14]=[r("span",null,"操作日志信息",-1)]))),default:s((()=>[o(ba,{gutter:20},{default:s((()=>[o(m,{span:12},{default:s((()=>[r("div",R,[e[15]||(e[15]=r("label",{class:"info-label"},"用户ID:",-1)),r("span",j,u(wa.value.userId||"未知"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",z,[e[16]||(e[16]=r("label",{class:"info-label"},"用户名:",-1)),r("span",B,u(wa.value.userName||"未知"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",E,[e[17]||(e[17]=r("label",{class:"info-label"},"操作动作:",-1)),r("span",A,u(wa.value.action),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",U,[e[18]||(e[18]=r("label",{class:"info-label"},"操作资源:",-1)),r("span",V,u(wa.value.resource),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",F,[e[19]||(e[19]=r("label",{class:"info-label"},"资源ID:",-1)),r("span",P,u(wa.value.resourceId||"未指定"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",W,[e[20]||(e[20]=r("label",{class:"info-label"},"操作结果:",-1)),o(d,{type:"成功"===wa.value.result?"success":"danger",size:"small"},{default:s((()=>[c(u(wa.value.result),1)])),_:1},8,["type"])])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",J,[e[21]||(e[21]=r("label",{class:"info-label"},"IP地址:",-1)),r("span",$,u(wa.value.ipAddress||"未知"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",q,[e[22]||(e[22]=r("label",{class:"info-label"},"耗时:",-1)),r("span",G,u(wa.value.duration?`${wa.value.duration}ms`:"未记录"),1)])])),_:1}),wa.value.userAgent?(p(),l(m,{key:0,span:24},{default:s((()=>[r("div",K,[e[23]||(e[23]=r("label",{class:"info-label"},"用户代理:",-1)),r("div",Z,u(wa.value.userAgent),1)])])),_:1})):i("",!0)])),_:1})])),_:1})):i("",!0),Ca.value?(p(),l(Ra,{key:2,shadow:"never",class:"info-card"},{header:s((()=>e[24]||(e[24]=[r("span",null,"通信日志信息",-1)]))),default:s((()=>[o(ba,{gutter:20},{default:s((()=>[o(m,{span:12},{default:s((()=>[r("div",H,[e[25]||(e[25]=r("label",{class:"info-label"},"通信通道:",-1)),r("span",M,u(La.value.channel),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",Q,[e[26]||(e[26]=r("label",{class:"info-label"},"设备ID:",-1)),r("span",X,u(La.value.deviceId||"未指定"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",Y,[e[27]||(e[27]=r("label",{class:"info-label"},"设备名称:",-1)),r("span",aa,u(La.value.deviceName||"未指定"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",ea,[e[28]||(e[28]=r("label",{class:"info-label"},"通信方向:",-1)),o(d,{type:"Request"===La.value.direction?"primary":"success",size:"small"},{default:s((()=>[c(u("Request"===La.value.direction?"请求":"响应"),1)])),_:1},8,["type"])])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",la,[e[29]||(e[29]=r("label",{class:"info-label"},"协议类型:",-1)),r("span",sa,u(La.value.protocol||"未知"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",ta,[e[30]||(e[30]=r("label",{class:"info-label"},"数据大小:",-1)),r("span",na,u(La.value.dataSize?`${La.value.dataSize} bytes`:"未记录"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",ia,[e[31]||(e[31]=r("label",{class:"info-label"},"响应时间:",-1)),r("span",oa,u(La.value.responseTime?`${La.value.responseTime}ms`:"未记录"),1)])])),_:1}),o(m,{span:12},{default:s((()=>[r("div",ra,[e[32]||(e[32]=r("label",{class:"info-label"},"状态码:",-1)),r("span",ua,u(La.value.statusCode||"未知"),1)])])),_:1}),La.value.endpoint?(p(),l(m,{key:0,span:24},{default:s((()=>[r("div",ca,[e[33]||(e[33]=r("label",{class:"info-label"},"端点地址:",-1)),r("div",da,u(La.value.endpoint),1)])])),_:1})):i("",!0)])),_:1})])),_:1})):i("",!0),a.logData.exception?(p(),l(Ra,{key:3,shadow:"never",class:"info-card"},{header:s((()=>[r("div",pa,[e[35]||(e[35]=r("span",null,"异常信息",-1)),o(f,{type:"primary",size:"small",onClick:e[1]||(e[1]=e=>Ta(a.logData.exception))},{default:s((()=>e[34]||(e[34]=[c(" 复制异常 ")]))),_:1,__:[34]})])])),default:s((()=>[o(ja,{"model-value":a.logData.exception,type:"textarea",rows:8,readonly:"",class:"exception-textarea"},null,8,["model-value"])])),_:1})):i("",!0),Ia.value?(p(),l(Ra,{key:4,shadow:"never",class:"info-card"},{header:s((()=>[r("div",fa,[e[37]||(e[37]=r("span",null,"扩展属性",-1)),o(f,{type:"primary",size:"small",onClick:e[2]||(e[2]=e=>Ta(JSON.stringify(a.logData.properties,null,2)))},{default:s((()=>e[36]||(e[36]=[c(" 复制属性 ")]))),_:1,__:[36]})])])),default:s((()=>{return[r("div",ma,[r("pre",va,u((e=a.logData.properties,e?JSON.stringify(e,null,2):"")),1)])];var e})),_:1})):i("",!0)])):i("",!0)])),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-0871113d"]]);function ya(a){return f({url:"/api/Log/system",method:"get",params:a})}function _a(a,e){return f({url:"/api/Log/system/statistics",method:"get",params:{startTime:a,endTime:e}})}function Da(a){return f({url:"/api/Log/system/export",method:"post",data:a,responseType:"blob"})}function ha(a){return f({url:"/api/Log/operation",method:"get",params:a})}function Ca(a,e){return f({url:"/api/Log/operation/statistics",method:"get",params:{startTime:a,endTime:e}})}function ka(a){return f({url:"/api/Log/operation/export",method:"post",data:a,responseType:"blob"})}function wa(a){return f({url:"/api/Log/communication",method:"get",params:a})}function La(a,e){return f({url:"/api/Log/communication/statistics",method:"get",params:{startTime:a,endTime:e}})}function Ia(a){return f({url:"/api/Log/communication/export",method:"post",data:a,responseType:"blob"})}function Sa(){return f({url:"/api/Log/overview",method:"get"})}function Oa(a,e=100){return f({url:"/api/Log/search",method:"get",params:{keyword:a,limit:e}})}export{ba as L,g as a,v as b,ya as c,_a as d,Da as e,ha as f,Sa as g,Ca as h,ka as i,wa as j,La as k,Ia as l,Oa as s};
